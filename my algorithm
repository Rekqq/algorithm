finish the algorithm in aha book
